<!-- The core Firebase JS SDK is always required and must be listed first -->
<!-- <script src="https://www.gstatic.com/firebasejs/7.2.2/firebase-app.js"></script> -->

<!-- TODO: Add SDKs for Firebase products that you want to use
     https://firebase.google.com/docs/web/setup#available-libraries -->
<!-- <script src="https://www.gstatic.com/firebasejs/7.2.2/firebase-analytics.js"></script> -->
<link rel="stylesheet" href="/static/css/style.css" />
<!-- Compiled and minified CSS -->
<link rel="stylesheet" href="/static/css/materialize.min.css" />
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" />

<!-- Compiled and minified JavaScript -->
<script src="/static/js/materialize.min.js"></script>
<style>
    .item-center {
        position: fixed;
        left: 50%;
        top: 50%;
        text-align: center;
    }
</style>
<html>

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>1Meeting</title>
</head>

<body>
    <nav>
        <div class="nav-wrapper green accent-4">
            <img src="/static/img/new_logo_reh.png" style="margin-top: 5px;" width="50" alt="">
            <span class="brand-logo"><b>1Meeting</b></span>
        </div>
    </nav>

    <div class="row">
        <div class="col s12 item-center">
            <a class="waves-effect waves-light btn-large pink accent-3 pulse" onclick="scanCode();">
                <i class="large material-icons left">qr_code_scanner</i><b>SCAN QR Code</b></a>
        </div>
    </div>
    <script src="https://static.line-scdn.net/liff/edge/2.1/liff.js"></script>
    <script>
        let users = []

        function scanCode() {
            liff.scanCode().then(data => {
                const stringifiedResult = JSON.stringify(data)
                alert(stringifiedResult)
                liff.getProfile()
                    .then(profile => {
                        const userId = profile.userId
                        const name = profile.displayName
                        document.getElementById('profile').innerHTML = name
                    })
                    .catch((err) => {
                        console.log('error', err);
                    });
                //alert(stringifiedResult)
            })
        }
        liff.init({
                liffId: '1655384297-5WyBeB7b'
            },
            () => {},
            err => console.error(err.code, error.message)
        )

        // function getOtp() {
        //     fetch('/getUsers', {
        //             mode: `cors`
        //         })
        //         .then(result => {
        //             return result.json()
        //         })
        //         .then(result => {
        //             users = result.users
        //             result.users.map((items, index) => {
        //                 var newParagraph = document.createElement('article' + index)
        //                 newParagraph.insertAdjacentHTML(
        //                     'beforeEnd',
        //                     '<div class=""> <div class="border"><div class="content" id="otp-' +
        //                     index +
        //                     '"></div></div></div>'
        //                 )
        //                 document.body.appendChild(newParagraph)
        //             })
        //         })

        //     setInterval(() => {
        //         users.map((items, index) => {
        //             fetch('/authen', {
        //                     mode: `cors`,
        //                     headers: {
        //                         'x-secret': items.secret
        //                     }
        //                 })
        //                 .then(result => {
        //                     return result.json()
        //                 })
        //                 .then(result => {
        //                     let textHtml =
        //                         '<div style="width:100%;"><p style="color:#353535; text-align:left; ">' +
        //                         items.type +
        //                         '</p>' +
        //                         '<p><div style="display:flex;align-items:center;"><div style="width:80%; text-align:left; font-size: 2.5rem; color:#486ab9; margin:-1rem 0">' +
        //                         result.otp +
        //                         '</div><div style="width:20%; text-align:center;"><button class="btn-floating  blue darken-3" onClick="deleteAccount(`' +
        //                         items.type +
        //                         ':' +
        //                         items.name +
        //                         '`);"><i class="material-icons">delete</i></button></div></div></p>' +
        //                         '<p style="color:#757575; width:50%;">' +
        //                         items.name +
        //                         '</p></div><br>'
        //                     document.getElementById('otp-' + index).innerHTML = textHtml
        //                 })
        //         })
        //     }, 1000)
        // }
        // var d = new Date()
        // var n = 30 - (d.getSeconds() % 30)
        // var timeleft = n
        // var downloadTimer = setInterval(function() {
        //     d = new Date()
        //     document.getElementById('countdown').innerHTML = +timeleft + ' seconds remaining'
        //     timeleft = 30 - (d.getSeconds() % 30)
        // }, 1000)
        // getOtp()
    </script>
</body>

</html>
